Package Source:	  python-keystoneclient


List of available patches
-------------------------
1000-cern-python-glanceclient-ssl.patch

This file contains the patch to use a root certificate in the client side of
the ssl configuration and also enable the --insecure option (self-signed certs)

1001-cern-python-glanceclient-relax-requirement.patch

This file allows the rpm to be installed with more recent version of keystoneclient
This is needed by ceilometer

How to apply
------------

1) Download and install the latest RPM for the package to use

   yumdownloader --source python-glanceclient


2) Copy the patches into the SOURCES folder (~/rpmbuild/SOURCES)

   cp 1000-cern-python-glanceclient-ssl.patch ~/rpmbuild/SOURCES


3) Add the version of the package to the Release field

   ...
   Name:             python-glanceclient
   # Since folsom-2 OpenStack clients follow their own release plan
   # and restarted version numbering from 0.1.1
   # https://lists.launchpad.net/openstack/msg14248.html
   Epoch:            1
   Version:          0.5.1
   Release:          1%{?dist}.1
   Summary:          Python API and CLI for OpenStack Glance
   ...


4) Add the patch at the end of the list of patches on the spec file in the SPECS folder (~/rpmbuild/SPECS)

   ...
   #
   # patches_base=0.5.1
   #
   Patch0001: 0001-Make-ConnectionRefused-error-more-informative.patch
   Patch0002: 0002-Fix-weird-None-displayed-on-some-errors.patch
   Patch0003: 0003-Typo-in-image-create-help-page.patch
   Patch0004: 0004-adjust-egg-info-for-Fedora.patch

   # CERN Patches
   Patch1000: 1000-cern-python-glanceclient-ssl.patch
   Patch1001: 1001-cern-python-glanceclient-relax-requirement.patch
   ...


5) Add the patch in the %prep section after all the previous patches have been applied 

   ...
   %prep
   %setup -q

   %patch0001 -p1
   %patch0002 -p1
   %patch0003 -p1
   %patch0004 -p1

   %patch1000 -p0
   %patch1001 -p1
   ...
  

6) Add a relevant entry on the %changelog section at the beginning. By convention we append ai6.n

   ...
   %changelog
   * Tue Feb 05 2013 Jose Castro Leon <jose.castro.leon@cern.ch> 1:0.5.1-1.ai6.1
   - Apply CERN SSL patch
   - Relax requirement on keystoneclient

   * Sat Sep 15 2012 Alan Pevec <apevec@redhat.com> 1:0.5.1-1
   - Update to 0.5.1
   ...

7) Build the source rpm from the spec file with the dist option set to ai6

   rpmbuild -ba ~/rpmbuild/SPECS/python-glanceclient.spec --define 'dist .ai6'


8) Submit the source rpm into koji

   koji build ai6 ~/rpmbuild/SRPMS/python-glanceclient-0.5.1-1.ai6.1.src.rpm
